@EndUserText.label: 'Monthly Sales by Country'
define view ZV_SALES_AGGR as
  select from z_salesorder as h
    inner join z_customer as c on c.client = h.client and c.customer_id = h.customer_id
{
  c.country_code,
  to_varchar( h.order_date, 'YYYY-MM' )  as year_month,
  sum( h.total_amount )                  as total_amount,
  count( distinct h.so_id )              as orders
}
where h.client = $session.client
group by c.country_code, to_varchar( h.order_date, 'YYYY-MM' )
